<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8">
        <title>Problema com Celery "process exiting with exitcode 1"</title>
        <link rel="stylesheet" href="/theme/css/main.css">
                <link href="/rss.xml" type="application/atom+xml" rel="alternate" title="Thiago Avelino Atom Feed" />
                
        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a href="http://github.com/avelino">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="/">Thiago Avelino </a></h1>
                <nav><ul>
                                                                                </ul></nav>
        </header><!-- /#banner -->
        <section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/2010/12/16/problema-com-celery-process-exiting-exitcode-1" rel="bookmark"
           title="Permalink to Problema com Celery "process exiting with exitcode 1"">Problema com Celery "process exiting with exitcode 1"</a></h1>
      <a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="avelino0">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
      <footer class="post-info">
        <abbr class="published" title="2010-12-16T22:34:00">
                Thu 16 December 2010
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="/author/avelino.html">avelino</a>
        </address>
        <p>In <a href="/category/avelino.html">Avelino</a>. </p>

</footer><!-- /.post-info -->      <p>Hoje estava rodando o Celery em um projeto e me deparei com um problema,
o "process exiting with exitcode 1" quando dava start no Celery:</p>
<div class="highlight"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">xen</span><span class="o">-</span><span class="mo">01</span> <span class="n">gonow</span><span class="p">]</span><span class="err">#</span> <span class="n">python2</span><span class="mf">.7</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">celeryd</span> <span class="o">-</span><span class="n">v</span> <span class="mi">2</span> <span class="o">-</span><span class="n">B</span> <span class="o">-</span><span class="n">s</span> <span class="n">celery</span> <span class="o">-</span><span class="n">E</span> <span class="o">-</span><span class="n">l</span> <span class="n">INFO</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">184</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="n">celery</span><span class="err">@</span><span class="n">xen</span><span class="o">-</span><span class="mo">01</span> <span class="n">v2</span><span class="mf">.1.3</span> <span class="n">is</span> <span class="n">starting</span><span class="p">.</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">185</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">celery</span><span class="o">-</span><span class="mf">2.1.3</span><span class="o">-</span><span class="n">py2</span><span class="mf">.7</span><span class="p">.</span><span class="n">egg</span><span class="o">/</span><span class="n">celery</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span> 
        <span class="n">worker</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">107</span><span class="o">:</span> <span class="n">UserWarning</span><span class="o">:</span> <span class="n">Running</span> <span class="n">celeryd</span> <span class="n">with</span> <span class="n">superuser</span> <span class="n">privileges</span> <span class="n">is</span> <span class="n">not</span> <span class="n">encouraged</span><span class="o">!</span>
<span class="err">  </span><span class="s">&quot;Running celeryd with superuser privileges is not encouraged!&quot;</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">185</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">celery</span><span class="o">-</span><span class="mf">2.1.3</span><span class="o">-</span><span class="n">py2</span><span class="mf">.7</span><span class="p">.</span><span class="n">egg</span><span class="o">/</span><span class="n">celery</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span>
        <span class="n">worker</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">110</span><span class="o">:</span> <span class="n">UserWarning</span><span class="o">:</span> <span class="n">Using</span> <span class="n">settings</span><span class="p">.</span><span class="n">DEBUG</span> <span class="n">leads</span> <span class="n">to</span> <span class="n">a</span> <span class="n">memory</span> <span class="n">leak</span><span class="p">,</span> <span class="n">never</span> <span class="n">use</span> <span class="n">this</span> <span class="n">setting</span> <span class="n">in</span> <span class="n">a</span> <span class="n">production</span> <span class="n">environment</span><span class="o">!</span>
<span class="err">  </span><span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Using settings.DEBUG leads to a memory leak, &quot;</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">188</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> 
<span class="n">Configuration</span> <span class="o">-&gt;</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">broker</span> <span class="o">-&gt;</span> <span class="n">ghettoq</span><span class="p">.</span><span class="n">taproot</span><span class="p">.</span><span class="n">Database</span><span class="o">:</span><span class="c1">//guest@localhost/</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">queues</span> <span class="o">-&gt;</span>
<span class="err">  </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span><span class="p">.</span> <span class="n">celery</span> <span class="o">-&gt;</span> <span class="n">exchange</span><span class="o">:</span><span class="n">celery</span> <span class="p">(</span><span class="n">direct</span><span class="p">)</span> <span class="n">binding</span><span class="o">:</span><span class="n">celery</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">concurrency</span> <span class="o">-&gt;</span> <span class="mi">2</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">loader</span> <span class="o">-&gt;</span> <span class="n">djcelery</span><span class="p">.</span><span class="n">loaders</span><span class="p">.</span><span class="n">DjangoLoader</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">logfile</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">stderr</span><span class="p">]</span><span class="err">@</span><span class="n">INFO</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">events</span> <span class="o">-&gt;</span> <span class="n">ON</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">beat</span> <span class="o">-&gt;</span> <span class="n">ON</span>
<span class="err">  </span> <span class="err"> </span><span class="p">.</span> <span class="n">tasks</span> <span class="o">-&gt;</span>
<span class="err">  </span> <span class="err"> </span> <span class="err"> </span> <span class="err"> </span><span class="p">.</span> <span class="n">gonow</span><span class="p">.</span><span class="n">vps</span><span class="p">.</span><span class="n">tasks</span><span class="p">.</span><span class="n">lvm</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">213</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">PoolWorker</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="n">child</span> <span class="n">process</span> <span class="n">calling</span> <span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">223</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">PoolWorker</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="n">child</span> <span class="n">process</span> <span class="n">calling</span> <span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">237</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">child</span> <span class="n">process</span> <span class="n">calling</span> <span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">239</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">Celerybeat</span><span class="o">:</span> <span class="n">Starting</span><span class="p">...</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">239</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="n">celery</span><span class="err">@</span><span class="n">xen</span><span class="o">-</span><span class="mo">01</span> <span class="n">has</span> <span class="n">started</span><span class="p">.</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">257</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">process</span> <span class="n">shutting</span> <span class="n">down</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">258</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">Process</span> <span class="n">Beat</span><span class="o">:</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">259</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">259</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/multiprocessing/process.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">232</span><span class="p">,</span> <span class="n">in</span> <span class="n">_bootstrap</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">284</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">285</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">392</span><span class="p">,</span> <span class="n">in</span> <span class="n">run</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">291</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">self</span><span class="p">.</span><span class="n">service</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="n">embedded_process</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">292</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">322</span><span class="p">,</span> <span class="n">in</span> <span class="n">start</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">292</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">humanize_seconds</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">scheduler</span><span class="p">.</span><span class="n">max_interval</span><span class="p">)))</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">292</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">362</span><span class="p">,</span> <span class="n">in</span> <span class="n">scheduler</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">292</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">self</span><span class="p">.</span><span class="n">_scheduler</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_scheduler</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">292</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">354</span><span class="p">,</span> <span class="n">in</span> <span class="n">get_scheduler</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">293</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">lazy</span><span class="o">=</span><span class="n">lazy</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">293</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/utils/</span>
        <span class="n">__init__</span><span class="p">.</span><span class="n">py</span><span class="s">&quot;, line 362, in instantiate</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">297</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="k">return</span> <span class="n">get_cls_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">298</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">274</span><span class="p">,</span> <span class="n">in</span> <span class="n">__init__</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">298</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">Scheduler</span><span class="p">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">298</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">150</span><span class="p">,</span> <span class="n">in</span> <span class="n">__init__</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">299</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">self</span><span class="p">.</span><span class="n">setup_schedule</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">299</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">279</span><span class="p">,</span> <span class="n">in</span> <span class="n">setup_schedule</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">299</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">self</span><span class="p">.</span><span class="n">merge_inplace</span><span class="p">(</span><span class="n">conf</span><span class="p">.</span><span class="n">CELERYBEAT_SCHEDULE</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">299</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;</span><span class="p">,</span>
        <span class="n">line</span> <span class="mi">250</span><span class="p">,</span> <span class="n">in</span> <span class="n">merge_inplace</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">299</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">:</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">300</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/UserDict.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">61</span><span class="p">,</span> <span class="n">in</span> <span class="n">get</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">310</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="k">return</span> <span class="n">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">310</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/UserDict.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">20</span><span class="p">,</span> <span class="n">in</span> <span class="n">__getitem__</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">310</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">311</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">File</span> <span class="s">&quot;/usr/local/lib/python2.7/shelve.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">122</span><span class="p">,</span> <span class="n">in</span> <span class="n">__getitem__</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">317</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">value</span> <span class="o">=</span> <span class="n">Unpickler</span><span class="p">(</span><span class="n">f</span><span class="p">).</span><span class="n">load</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">318</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">EOFError</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">318</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">process</span> <span class="n">exiting</span> <span class="n">with</span> <span class="n">exitcode</span> <span class="mi">1</span>
</pre></div>


<p>O motivo desse error é que antes de dar start no Celery ele já esta
rodando em memoria. Quando rodamos o Celery ele cria alguns arquivos no
projeto para gerenciamento de Task, um dele é o celery.dir  que guarda
informações das function que vai ser processada de X em X tempo.</p>
<p>Bom a solução para esse casa é apagar o arquivo "celery.dir" assim ele
zera o task do Celery, quando der start novamente ele recria o
"celery.dir".</p>
<p>Agora ele só normal:</p>
<div class="highlight"><pre><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">xen</span><span class="o">-</span><span class="mo">01</span> <span class="n">gonow</span><span class="p">]</span><span class="err">#</span> <span class="n">python2</span><span class="mf">.7</span> <span class="n">manage</span><span class="p">.</span><span class="n">py</span> <span class="n">celeryd</span> <span class="o">-</span><span class="n">v</span> <span class="mi">2</span> <span class="o">-</span><span class="n">B</span> <span class="o">-</span><span class="n">s</span> <span class="n">celery</span> <span class="o">-</span><span class="n">E</span> <span class="o">-</span><span class="n">l</span> <span class="n">INFO</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">539</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="n">celery</span><span class="err">@</span><span class="n">xen</span><span class="o">-</span><span class="mo">01</span> <span class="n">v2</span><span class="mf">.1.3</span> <span class="n">is</span> <span class="n">starting</span><span class="p">.</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">540</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">celery</span><span class="o">-</span><span class="mf">2.1.3</span><span class="o">-</span><span class="n">py2</span><span class="mf">.7</span><span class="p">.</span><span class="n">egg</span><span class="o">/</span><span class="n">celery</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span>
        <span class="n">worker</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">107</span><span class="o">:</span> 
        <span class="n">UserWarning</span><span class="o">:</span> <span class="n">Running</span> <span class="n">celeryd</span> <span class="n">with</span> <span class="n">superuser</span> <span class="n">privileges</span> <span class="n">is</span> <span class="n">not</span> <span class="n">encouraged</span><span class="o">!</span>
  <span class="s">&quot;Running celeryd with superuser privileges is not encouraged!&quot;</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">540</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">celery</span><span class="o">-</span><span class="mf">2.1.3</span><span class="o">-</span><span class="n">py2</span><span class="mf">.7</span><span class="p">.</span><span class="n">egg</span><span class="o">/</span><span class="n">celery</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span>
        <span class="n">worker</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">110</span><span class="o">:</span>
        <span class="nl">UserWarning:</span> <span class="n">Using</span> <span class="n">settings</span><span class="p">.</span><span class="n">DEBUG</span> <span class="n">leads</span> <span class="n">to</span> <span class="n">a</span> <span class="n">memory</span> <span class="n">leak</span><span class="p">,</span> <span class="n">never</span> <span class="n">use</span> <span class="n">this</span> <span class="n">setting</span> <span class="n">in</span> <span class="n">a</span> <span class="n">production</span> <span class="n">environment</span><span class="o">!</span>
  <span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span><span class="s">&quot;Using settings.DEBUG leads to a memory leak, &quot;</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">543</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span>  
<span class="n">Configuration</span> <span class="o">-&gt;</span>
    <span class="p">.</span> <span class="n">broker</span> <span class="o">-&gt;</span> <span class="n">ghettoq</span><span class="p">.</span><span class="n">taproot</span><span class="p">.</span><span class="n">Database</span><span class="o">:</span><span class="c1">//guest@localhost/</span>
    <span class="p">.</span> <span class="n">queues</span> <span class="o">-&gt;</span>
        <span class="p">.</span> <span class="n">celery</span> <span class="o">-&gt;</span> <span class="n">exchange</span><span class="o">:</span><span class="n">celery</span> <span class="p">(</span><span class="n">direct</span><span class="p">)</span> <span class="n">binding</span><span class="o">:</span><span class="n">celery</span>
    <span class="p">.</span> <span class="n">concurrency</span> <span class="o">-&gt;</span> <span class="mi">2</span>
    <span class="p">.</span> <span class="n">loader</span> <span class="o">-&gt;</span> <span class="n">djcelery</span><span class="p">.</span><span class="n">loaders</span><span class="p">.</span><span class="n">DjangoLoader</span>
    <span class="p">.</span> <span class="n">logfile</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">stderr</span><span class="p">]</span><span class="err">@</span><span class="n">INFO</span>
    <span class="p">.</span> <span class="n">events</span> <span class="o">-&gt;</span> <span class="n">ON</span>
    <span class="p">.</span> <span class="n">beat</span> <span class="o">-&gt;</span> <span class="n">ON</span>
    <span class="p">.</span> <span class="n">tasks</span> <span class="o">-&gt;</span>
        <span class="p">.</span> <span class="n">gonow</span><span class="p">.</span><span class="n">vps</span><span class="p">.</span><span class="n">tasks</span><span class="p">.</span><span class="n">lvm</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">568</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">PoolWorker</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="n">child</span> <span class="n">process</span> <span class="n">calling</span> <span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">578</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">PoolWorker</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="n">child</span> <span class="n">process</span> <span class="n">calling</span> <span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">591</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">child</span> <span class="n">process</span> <span class="n">calling</span> <span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">593</span><span class="o">:</span> <span class="n">INFO</span><span class="o">/</span><span class="n">Beat</span><span class="p">]</span> <span class="n">Celerybeat</span><span class="o">:</span> <span class="n">Starting</span><span class="p">...</span>
<span class="p">[</span><span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">16</span> <span class="mi">09</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mi">28</span><span class="p">,</span><span class="mi">596</span><span class="o">:</span> <span class="n">WARNING</span><span class="o">/</span><span class="n">MainProcess</span><span class="p">]</span> <span class="n">celery</span><span class="err">@</span><span class="n">xen</span><span class="o">-</span><span class="mo">01</span> <span class="n">has</span> <span class="n">started</span><span class="p">.</span>
</pre></div>
    </div><!-- /.entry-content -->
    
  </article>
</section>
        <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://getpelican.com/">Pelican</a></li>
                                                    <li><a href="http://python.org/">Python.org</a></li>
                                                    <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                                                    <li><a href="#">You can modify those links in your config file</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/rss.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            
                                                    <li><a href="http://twitter.com/avelino0">twitter</a></li>
                                                    <li><a href="http://github.com/avelino">github</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>