<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Thiago Avelino</title><link href="/" rel="alternate"></link><link href="/category/avelino-experiencia-infra-nginx/rss.xml" rel="self"></link><id>/</id><updated>2012-08-09T13:05:00+02:00</updated><entry><title>Proxy transparente com Nginx</title><link href="/2012/08/09/proxy-transparente-com-nginx" rel="alternate"></link><updated>2012-08-09T13:05:00+02:00</updated><author><name>avelino</name></author><id>tag:,2012-08-09:2012/08/09/proxy-transparente-com-nginx</id><summary type="html">&lt;p&gt;Muitas pessoas usam Squid para fazer qual quer tipo de proxy, ate mesmo
para proxy transparente para usar em servidor web, por exemplo:&lt;/p&gt;
&lt;p&gt;Você tem um site que precisa ter IP aqui no Brasil so que como o custo
de servidor e link aqui no Brasil é muito caro, você pode fazer um proxy
transparente para o servidor aqui no Brasil ser um cara que vai receber
a requisição e repassar para o outro servidor que esteja em qual quer
lugar do mundo. Com essa solução podemos ter uma maquina simples
(maquina com pouco poder de processamento) pois ela só vai receber o
trafego e repassar para o servidor que esteja em outro local.&lt;/p&gt;
&lt;p&gt;Vamos imaginar um exemplo pratico, preciso que o usuário acesse o IP
177.71.248.185 (é um servidor da Amazon no Brasil), esse servidor
precisa receber a requisição e repassar para o IP 67.159.35.2 (é maquina
principal onde é processado o backend, esse servidor esta fora
do Brasi). Foi usado essa solução em um portal que atendo para ter baixa
latencia.&lt;/p&gt;
&lt;p&gt;Vamos ao exemplo pratico:&lt;/p&gt;
&lt;p&gt;[gist id=3304942]&lt;/p&gt;
&lt;p&gt;Criei um "upstream server" para falar qual é o servidor de destino do
trafego, na configuração acima tem um cache de 30 minutos pois no
servidor principal tem cache de 4 horas.&lt;/p&gt;
&lt;p&gt;Logicamente que existe desvantagem com isso, pois vamos estar trafegando
em duas (ou mais) redes, assim usando o trafego do servidor que esta
recebendo a primeira requisição e do segunda que esta recebendo um
requisição do primeiro.&lt;/p&gt;</summary><category term="nginx"></category><category term="proxy"></category><category term="router"></category><category term="transparente"></category></entry></feed>