

<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  



<title>Problema com Celery &#34;process exiting with exitcode 1&#34; - Avelino</title>


<meta name="keywords" content="python,celery,django">
<link rel="amphtml" href="https://r.amply.cloud/?url=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f">



  <meta name="author" content="Avelino">
  <base href="https://avelino.run/">
  <link rel="canonical" href="https://avelino.run/problema-com-celery-process-exiting-with-exitcode-1/">

  <meta name="generator" content="Hugo 0.51-DEV" />

  
  

  
  <link href="https://avelino.run/css/main.css?hash=1541291284" rel="stylesheet">
  <link href="https://avelino.run/css/highlightjs-dracula.css?hash=1541291284" rel="stylesheet">

  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Mono|Inconsolata" rel="stylesheet">
  <link href="https://cdn.materialdesignicons.com/2.0.46/css/materialdesignicons.min.css" rel="stylesheet">
</head>

<body lang="en-us">



  <div class="menu">
    <div class="container">
      <div class="row">
        <div class="menu__wrapper d-none d-lg-block col-md-12">
          <nav class="">
            <ul>
              <li><a href="#hello">Hello</a></li>
              <li><a href="#projects">Projects</a></li>
	      
	      <li><a href="https://avelino.run/blog/#content" alt="content Blogs">Blogs</a></li>
	      
	      <li><a href="https://avelino.run/quote/#content" alt="content Quotes">Quotes</a></li>
	      
            </ul>
          </nav>
        </div>
        <div class="menu__wrapper col-md-12 d-lg-none">
          <button type="button" class="menu__mobile-button">
            <span><i class="fa fa-bars" aria-hidden="true"></i></span>
          </button>
        </div>
      </div>
    </div>
  </div>



  <div class="mobile-menu d-lg-none">
    <div class="container">
      <div class="mobile-menu__close">
        <span><i class="mdi mdi-close" aria-hidden="true"></i></span>
      </div>
      <nav class="mobile-menu__wrapper">
        <ul>
          <li><a href="#hello">Hello</a></li>
          <li><a href="#portfolio">Projects</a></li>
	  
	  <li><a href="https://avelino.run/blog/#content" alt="content Blogs">Blogs</a></li>
	  
	  <li><a href="https://avelino.run/quote/#content" alt="content Quotes">Quotes</a></li>
	  
        </ul>
      </nav>
    </div>
  </div>




<header class="background blog-header"></header>



<div class="container">
  <div class="article">
    <div class="row">
      <div class="col-md-12">
        <a class="article__back-link" href="/"><i class="fa fa-long-arrow-left" aria-hidden="true"></i>Back</a>

        <h1 class="article__title">Problema com Celery &#34;process exiting with exitcode 1&#34;</h1>
        <p class="article_date">
	  Dec 26, 2010 | 3 minutes read
	</p>
	
<p class="article__share">Share this post:
  <a rel="nofollow" href="https://twitter.com/intent/tweet?text=Problema%20com%20Celery%20%22process%20exiting%20with%20exitcode%201%22 https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f by @avelinorun" target="_blank"><i class="fa fa-twitter-square"></i></a>
  <a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-facebook-square"></i></a>
  <a rel="nofollow" href="https://www.linkedin.com/cws/share?url=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-linkedin-square"></i></a>
  <a rel="nofollow" href="https://plus.google.com/share?url=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-google-plus-square"></i></a>
  <a rel="nofollow" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-pinterest-square"></i></a>
</p>



	<p>Hoje estava rodando o Celery em um projeto e me deparei com um problema, o &ldquo;process exiting with exitcode 1&rdquo; quando dava start no Celery:</p>

<pre><code class="language-shell">[root@xen-01 gonow]# python2.7 manage.py celeryd -v 2 -B -s celery -E -l INFO
[2010-12-16 09:18:13,184: WARNING/MainProcess] celery@xen-01 v2.1.3 is starting.
[2010-12-16 09:18:13,185: WARNING/MainProcess] /usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/apps/
        worker.py:107: UserWarning: Running celeryd with superuser privileges is not encouraged!
  &quot;Running celeryd with superuser privileges is not encouraged!&quot;)
[2010-12-16 09:18:13,185: WARNING/MainProcess] /usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/apps/
        worker.py:110: UserWarning: Using settings.DEBUG leads to a memory leak, never use this setting in a production environment!
  warnings.warn(&quot;Using settings.DEBUG leads to a memory leak, &quot;
[2010-12-16 09:18:13,188: WARNING/MainProcess]
Configuration -&gt;
    . broker -&gt; ghettoq.taproot.Database://guest@localhost/
    . queues -&gt;
        . celery -&gt; exchange:celery (direct) binding:celery
    . concurrency -&gt; 2
    . loader -&gt; djcelery.loaders.DjangoLoader
    . logfile -&gt; [stderr]@INFO
    . events -&gt; ON
    . beat -&gt; ON
    . tasks -&gt;
        . gonow.vps.tasks.lvm
[2010-12-16 09:18:13,213: INFO/PoolWorker-2] child process calling self.run()
[2010-12-16 09:18:13,223: INFO/PoolWorker-3] child process calling self.run()
[2010-12-16 09:18:13,237: INFO/Beat] child process calling self.run()
[2010-12-16 09:18:13,239: INFO/Beat] Celerybeat: Starting...
[2010-12-16 09:18:13,239: WARNING/MainProcess] celery@xen-01 has started.
[2010-12-16 09:18:13,257: INFO/Beat] process shutting down
[2010-12-16 09:18:13,258: WARNING/Beat] Process Beat:
[2010-12-16 09:18:13,259: WARNING/Beat] Traceback (most recent call last):
[2010-12-16 09:18:13,259: WARNING/Beat] File &quot;/usr/local/lib/python2.7/multiprocessing/process.py&quot;, line 232, in _bootstrap
[2010-12-16 09:18:13,284: WARNING/Beat] self.run()
[2010-12-16 09:18:13,285: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 392, in run
[2010-12-16 09:18:13,291: WARNING/Beat] self.service.start(embedded_process=True)
[2010-12-16 09:18:13,292: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 322, in start
[2010-12-16 09:18:13,292: WARNING/Beat] humanize_seconds(self.scheduler.max_interval)))
[2010-12-16 09:18:13,292: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 362, in scheduler
[2010-12-16 09:18:13,292: WARNING/Beat] self._scheduler = self.get_scheduler()
[2010-12-16 09:18:13,292: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 354, in get_scheduler
[2010-12-16 09:18:13,293: WARNING/Beat] lazy=lazy)
[2010-12-16 09:18:13,293: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/utils/
        __init__.py&quot;, line 362, in instantiate
[2010-12-16 09:18:13,297: WARNING/Beat] return get_cls_by_name(name)(*args, **kwargs)
[2010-12-16 09:18:13,298: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 274, in __init__
[2010-12-16 09:18:13,298: WARNING/Beat] Scheduler.__init__(self, *args, **kwargs)
[2010-12-16 09:18:13,298: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 150, in __init__
[2010-12-16 09:18:13,299: WARNING/Beat] self.setup_schedule()
[2010-12-16 09:18:13,299: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 279, in setup_schedule
[2010-12-16 09:18:13,299: WARNING/Beat] self.merge_inplace(conf.CELERYBEAT_SCHEDULE)
[2010-12-16 09:18:13,299: WARNING/Beat] File &quot;/usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/beat.py&quot;,
        line 250, in merge_inplace
[2010-12-16 09:18:13,299: WARNING/Beat] if self.get(key):
[2010-12-16 09:18:13,300: WARNING/Beat] File &quot;/usr/local/lib/python2.7/UserDict.py&quot;, line 61, in get
[2010-12-16 09:18:13,310: WARNING/Beat] return self[key]
[2010-12-16 09:18:13,310: WARNING/Beat] File &quot;/usr/local/lib/python2.7/UserDict.py&quot;, line 20, in __getitem__
[2010-12-16 09:18:13,310: WARNING/Beat] return self.data[key]
[2010-12-16 09:18:13,311: WARNING/Beat] File &quot;/usr/local/lib/python2.7/shelve.py&quot;, line 122, in __getitem__
[2010-12-16 09:18:13,317: WARNING/Beat] value = Unpickler(f).load()
[2010-12-16 09:18:13,318: WARNING/Beat] EOFError
[2010-12-16 09:18:13,318: INFO/Beat] process exiting with exitcode 1
</code></pre>

<p>O motivo desse error é que antes de dar start no Celery ele já esta rodando em memoria. Quando rodamos o Celery ele cria alguns arquivos no projeto para gerenciamento de Task, um dele é o celery.dir  que guarda informações das function que vai ser processada de X em X tempo.</p>

<p>Bom a solução para esse casa é apagar o arquivo &ldquo;celery.dir&rdquo; assim ele zera o task do Celery, quando der start novamente ele recria o &ldquo;celery.dir&rdquo;.</p>

<p>Agora ele só normal:</p>

<pre><code class="language-shell">[root@xen-01 gonow]# python2.7 manage.py celeryd -v 2 -B -s celery -E -l INFO
[2010-12-16 09:18:28,539: WARNING/MainProcess] celery@xen-01 v2.1.3 is starting.
[2010-12-16 09:18:28,540: WARNING/MainProcess] /usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/apps/
        worker.py:107:
        UserWarning: Running celeryd with superuser privileges is not encouraged!
  &quot;Running celeryd with superuser privileges is not encouraged!&quot;)
[2010-12-16 09:18:28,540: WARNING/MainProcess] /usr/local/lib/python2.7/site-packages/celery-2.1.3-py2.7.egg/celery/apps/
        worker.py:110:
        UserWarning: Using settings.DEBUG leads to a memory leak, never use this setting in a production environment!
  warnings.warn(&quot;Using settings.DEBUG leads to a memory leak, &quot;
[2010-12-16 09:18:28,543: WARNING/MainProcess]
Configuration -&gt;
    . broker -&gt; ghettoq.taproot.Database://guest@localhost/
    . queues -&gt;
        . celery -&gt; exchange:celery (direct) binding:celery
    . concurrency -&gt; 2
    . loader -&gt; djcelery.loaders.DjangoLoader
    . logfile -&gt; [stderr]@INFO
    . events -&gt; ON
    . beat -&gt; ON
    . tasks -&gt;
        . gonow.vps.tasks.lvm
[2010-12-16 09:18:28,568: INFO/PoolWorker-2] child process calling self.run()
[2010-12-16 09:18:28,578: INFO/PoolWorker-3] child process calling self.run()
[2010-12-16 09:18:28,591: INFO/Beat] child process calling self.run()
[2010-12-16 09:18:28,593: INFO/Beat] Celerybeat: Starting...
[2010-12-16 09:18:28,596: WARNING/MainProcess] celery@xen-01 has started.
</code></pre>


	
<p class="article__share">Share this post:
  <a rel="nofollow" href="https://twitter.com/intent/tweet?text=Problema%20com%20Celery%20%22process%20exiting%20with%20exitcode%201%22 https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f by @avelinorun" target="_blank"><i class="fa fa-twitter-square"></i></a>
  <a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-facebook-square"></i></a>
  <a rel="nofollow" href="https://www.linkedin.com/cws/share?url=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-linkedin-square"></i></a>
  <a rel="nofollow" href="https://plus.google.com/share?url=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-google-plus-square"></i></a>
  <a rel="nofollow" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2favelino.run%2fproblema-com-celery-process-exiting-with-exitcode-1%2f"><i class="fa fa-pinterest-square"></i></a>
</p>



	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "avelino" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </div>
  </div>
</div>




<div class="background">
  <div id="contact" class="container section">
    <div class="row contacts">
      <div class="col-lg-12">
        <div class="footer">

	  
<p class="personal-profile__social">
  <a rel="nofollow" href="https://github.com/avelino" target="_blank"><i class="fa fa-github-square"></i></a>
  <a rel="nofollow" href="https://instagram.com/avelinorun" target="_blank"><i class="fa fa-instagram"></i></a>
  <a rel="nofollow" href="https://twitter.com/avelino" target="_blank"><i class="fa fa-twitter-square"></i></a>
  
  <a rel="nofollow" href="https://linkedin.com/in/avelinorun" target="_blank"><i class="fa fa-linkedin-square"></i></a>
  
</p>



	  
	  <p>written by Avelino</p>
	  
	  <p><a href="https://github.com/avelino/hugo-theme-sarah" target="_blank">Sarah</a> theme for <a href="http://gohugo.io/" target="_blank">Hugo</a>. © <a href="http://avelino.xxx/" target="_blank">Avelino</a> 2018</p>
        </div>
      </div>
    </div>
  </div>
</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js" integrity="sha256-jDnOKIOq2KNsQZTcBTEnsp76FnfMEttF6AV2DF2fFNE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/go.min.js"></script>


<script src="https://avelino.run/js/menu.js?hash=1541291284"></script>
<script src="https://avelino.run/js/progress-list.js?hash=1541291284"></script>
<script src="https://avelino.run/js/section.js?hash=1541291284"></script>
<script src="https://avelino.run/js/mobile-menu.js?hash=1541291284"></script>
<script src="https://avelino.run/js/mbclicker.min.js?hash=1541291284"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-3063031-15', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>

