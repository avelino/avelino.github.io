

<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  



<title>Guia de estilo para pacotes Go - Avelino</title>


<meta name="keywords" content="golang,style guide,guia de estilo,packages,pacotes">
<link rel="amphtml" href="https://r.amply.cloud/?url=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f">



  <meta name="author" content="Avelino">
  <base href="https://avelino.run/">
  <link rel="canonical" href="https://avelino.run/guia-de-estilo-para-pacotes-go/">

  <meta name="generator" content="Hugo 0.51-DEV" />

  
  

  
  <link href="https://avelino.run/css/main.css?hash=1541291284" rel="stylesheet">
  <link href="https://avelino.run/css/highlightjs-dracula.css?hash=1541291284" rel="stylesheet">

  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Mono|Inconsolata" rel="stylesheet">
  <link href="https://cdn.materialdesignicons.com/2.0.46/css/materialdesignicons.min.css" rel="stylesheet">
</head>

<body lang="en-us">



  <div class="menu">
    <div class="container">
      <div class="row">
        <div class="menu__wrapper d-none d-lg-block col-md-12">
          <nav class="">
            <ul>
              <li><a href="#hello">Hello</a></li>
              <li><a href="#projects">Projects</a></li>
	      
	      <li><a href="https://avelino.run/blog/#content" alt="content Blogs">Blogs</a></li>
	      
	      <li><a href="https://avelino.run/quote/#content" alt="content Quotes">Quotes</a></li>
	      
            </ul>
          </nav>
        </div>
        <div class="menu__wrapper col-md-12 d-lg-none">
          <button type="button" class="menu__mobile-button">
            <span><i class="fa fa-bars" aria-hidden="true"></i></span>
          </button>
        </div>
      </div>
    </div>
  </div>



  <div class="mobile-menu d-lg-none">
    <div class="container">
      <div class="mobile-menu__close">
        <span><i class="mdi mdi-close" aria-hidden="true"></i></span>
      </div>
      <nav class="mobile-menu__wrapper">
        <ul>
          <li><a href="#hello">Hello</a></li>
          <li><a href="#portfolio">Projects</a></li>
	  
	  <li><a href="https://avelino.run/blog/#content" alt="content Blogs">Blogs</a></li>
	  
	  <li><a href="https://avelino.run/quote/#content" alt="content Quotes">Quotes</a></li>
	  
        </ul>
      </nav>
    </div>
  </div>




<header class="background blog-header"></header>



<div class="container">
  <div class="article">
    <div class="row">
      <div class="col-md-12">
        <a class="article__back-link" href="/"><i class="fa fa-long-arrow-left" aria-hidden="true"></i>Back</a>

        <h1 class="article__title">Guia de estilo para pacotes Go</h1>
        <p class="article_date">
	  Apr 2, 2018 | 8 minutes read
	</p>
	
<p class="article__share">Share this post:
  <a rel="nofollow" href="https://twitter.com/intent/tweet?text=Guia%20de%20estilo%20para%20pacotes%20Go https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f by @avelinorun" target="_blank"><i class="fa fa-twitter-square"></i></a>
  <a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-facebook-square"></i></a>
  <a rel="nofollow" href="https://www.linkedin.com/cws/share?url=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-linkedin-square"></i></a>
  <a rel="nofollow" href="https://plus.google.com/share?url=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-google-plus-square"></i></a>
  <a rel="nofollow" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-pinterest-square"></i></a>
</p>



	

<p>Tradução do blogpost <a href="https://rakyll.org/style-packages/" target="_blank">Style guideline for Go packages</a> escrito pela <a href="https://twitter.com/rakyll" target="_blank">@rakyll</a>.</p>

<p><img src="/one-code-style-to-rule-all.jpg#center" alt="One code style to rule all" /></p>

<p>Código organizado em Go é fácil de entender, usar e ler. A falta de organização em código Go é tão crítica quanto as APIs mal projetadas. Os diretórios, nome e a estrutura dos seus pacotes são os primeiros elementos com os quais os utilizadores vêem e interagem.</p>

<p>O objetivo deste blogpost é ajudá-lo(a) com boas práticas comuns para não definir regras ruins. Você deve sempre usar o seu julgamento para escolher a solução mais elegante para sua implementação.</p>

<h2 id="pacotes">Pacotes</h2>

<p>Todos os códigos Go são organizados em pacotes. Pacote em Go é simplesmente um diretório (pasta) com um ou mais arquivos <code>.go</code> dentro dele. Pacotes Go fornecem isolamento e organização de código semelhante a diretórios e organização de arquivos em um computador.</p>

<p>Todo o código Go vive em um pacote e um pacote é o ponto de entrada para acessar o código Go. Compreender e estabelecer boas práticas em torno de pacotes é importante para escrever um bom pacote (código) Go.</p>

<h2 id="organização-do-pacote">Organização do pacote</h2>

<p>Vamos começar com sugestões de como você deve organizar código Go e explicar convenções sobre o nome de pacotes Go.</p>

<h3 id="usar-vários-arquivos">Usar vários arquivos</h3>

<p>Pacote é um diretório com um ou mais arquivos Go. Sinta-se livre para separar seu código em quantos arquivos achar melhor para a legibilidade ideal.</p>

<p>Por exemplo, o pacote HTTP pode ter sido separado em arquivos diferentes de acordo com o aspecto de handles HTTP. No exemplo a seguir, o pacote HTTP é dividido em alguns arquivos: tipos do cabeçalho e código, tipos de cookie e código, a implementação HTTP real e a documentação do pacote.</p>

<pre><code class="language-markdown">- doc.go       // documentação do pacote
- headers.go   // HTTP tipos de headers e código
- cookies.go   // HTTP tipos de cookies e código
- http.go      // HTTP implementação do cliente, request e tipo de response, etc.
</code></pre>

<h3 id="manter-os-tipos-próximos">Manter os tipos próximos</h3>

<p>Como regra geral, mantenha os tipos mais próximos de onde eles são usados. Isso tornará mais fácil qualquer contribuição e manutenção (para você ou outra pessoa externa) para encontrar um tipo. Um bom lugar para as estruturas de dados (<em>struct</em>) pode estar no começo do arquivo <code>headers.go</code>.</p>

<pre><code class="language-bash">$ cat headers.go
package http

// Header represents an HTTP header.
type Header struct {...}
</code></pre>

<p>A linguagem Go não restrige onde você deve definir os tipos, uma boa prática é manter os tipos na parte superior do arquivo, dentro do pacote que ele faz parte.</p>

<h3 id="organização-por-responsabilidade">Organização por responsabilidade</h3>

<p>Uma prática comum de outras linguagens é organizar tipos juntos em um pacote chamado <em>modelos</em> (ou algum nome nessa linha). Em Go, nós organizamos o código por suas responsabilidades funcionais.</p>

<pre><code class="language-go">package models // DON'T DO IT!!!

// User represents a user in the system.
type User struct {...}
</code></pre>

<p>Em vez de criar um pacote chamado <em>modelos</em> e declarar todos os tipos de entidade lá, um tipo de usuário deve viver em um pacote de camada de serviço.</p>

<pre><code class="language-go">package mngtservice

// User represents a user in the system.
type User struct {...}

func UsersByQuery(ctx context.Context, q *Query) ([]*User, *Iterator, error)

func UserIDByEmail(ctx context.Context, email string) (int64, error)
</code></pre>

<h3 id="pensando-no-godoc">Pensando no godoc</h3>

<p>Não é muito facil pensar (usar) Godoc na fase inicial do desenvolvimento da API do seu pacote para ver como seus conceitos serão renderizados no doc. Muitas vezes, essa visualização tem um impacto sobre o projeto (em geral para melhor). Godoc é a forma como os usuários vão consumir um pacote, por isso é extremamente importante ajustar as coisas para torná-las mais acessíveis, tenha certeza que isso melhora a API dos seus pacotes.</p>

<h3 id="exemplos-para-preencher-as-lacunas">Exemplos para preencher as lacunas</h3>

<p>Em alguns casos, talvez não seja possível fornecer todos os tipos relacionados de um único pacote. Pode ser confuso fazer isso (em uma fase inicial), você pode querer publicar implementações concretas de uma interface comum de pacote separado ou esses tipos podem ser propriedade de um pacote de terceiros. Dê exemplos para ajudar o usuário a descobrir e entender como eles são usados juntos.</p>

<pre><code class="language-bash">$ godoc cloud.google.com/go/datastore
func NewClient(ctx context.Context, projectID string, opts ...option.ClientOption) (*Client, error)
...
</code></pre>

<p><code>NewClient</code> trabalha com <code>option.ClientOptions</code> mas não é nem o pacote de armazenamento de informações nem o pacote de opção que exporta todos os tipos de opção.</p>

<pre><code class="language-bash">$ godoc google.golang.org/extraoption
func WithCustomValue(v string) option.ClientOption
...
</code></pre>

<p>Caso a API do seu pacote exija que muitos pacotes <strong>não padrão</strong> sejam importados, é útil adicionar um <a href="https://blog.golang.org/examples" target="_blank">exemplo Go</a> para mostrar aos usuários código de exemplo.</p>

<p>Exemplos é uma ótima maneira de aumentar a visibilidade de um pacote menos descoberto. Por exemplo, para <code>datastore.NewClient</code> pode referenciar o pacote de opção extra.</p>

<h3 id="não-exportar-de-main">Não exportar de <strong>main</strong></h3>

<p>Um identificador pode ser <a href="https://golang.org/ref/spec#Exported_identifiers" target="_blank">exportado</a> para permitir o acesso a ele de outro pacote.</p>

<p>Os pacotes principais não são importáveis, portanto, exportar identificadores de pacotes principais é desnecessário. Não exporte identificadores de um pacote principal se você estiver construindo o pacote para um binário.</p>

<p>Exceções a esta regra podem ser os principais pacotes incorporados um <code>.so</code>, <code>.a</code> ou <strong>Go plugin</strong>. Em tais casos, código Go pode ser usado a partir de outras linguagens através da <a href="https://golang.org/cmd/cgo/#hdr-C_references_to_Go" target="_blank">funcionalidade exportar CGO</a> e identificadores de exportação são necessários.</p>

<h2 id="nome-do-pacote">Nome do pacote</h2>

<p>O nome do pacote e caminho de importação são ambos identificadores significativos do seu pacote e representam tudo o que o seu pacote contém. Nomear seus pacotes canônicamente melhora não apenas sua qualidade de código, mas principalmente para os usuários do pacote que você esta criando/mantendo.</p>

<h3 id="somente-em-minúsculas-lowercase">Somente em minúsculas (lowercase)</h3>

<p>Os nomes dos pacotes devem ser minúsculos. Não use <code>snake_case</code> ou <code>camelCase</code> em nomes de pacote. O Go blog tem um <a href="https://blog.golang.org/package-names" target="_blank">guia abrangente</a> sobre nomear pacotes com uma boa variedade de exemplos.</p>

<h3 id="nomes-curtos-mas-representativos">Nomes curtos, mas representativos</h3>

<p>Os nomes dos pacotes devem ser <strong>curtos</strong>, mas devem ser <strong>exclusivos</strong> e <strong>representativos</strong>. Os usuários do pacote devem ser capazes de entender sua finalidade a partir do nome, sem necessidade de ler documentação (esse trabalho não é nada fácil, mas é possível).</p>

<p>Evite nomes de pacotes demasiado amplos como &ldquo;common&rdquo; e &ldquo;util&rdquo;.</p>

<pre><code class="language-go">import &quot;pkgs.org/common&quot; // DON'T!!!
</code></pre>

<p>Evite nomes duplicados em casos que o usuário precise importar o mesmo pacote.</p>

<p>Se você não pode evitar um nome ruim, é muito provável que haja um problema com sua estrutura geral e organização de código, esse é um grande alerta para repensar do design da sua API.</p>

<h3 id="claro-caminho-de-importação">Claro caminho de importação</h3>

<p>Evite expor sua estrutura personalizada de repositório aos usuários. Alinhe bem com as convenções <code>GOPATH</code>. Evite ter <code>src/</code>, <code>pkg/</code> e etc, no caminho da importação.</p>

<pre><code class="language-go">github.com/user/repo/src/httputil   // DON'T DO IT, AVOID SRC!!

github.com/user/repo/gosrc/httputil // DON'T DO IT, AVOID GOSRC!!
</code></pre>

<h3 id="sem-plural">Sem plural</h3>

<p>Em Go, os nomes dos pacotes não são plurais. Isso é surpreendente para os programadores que vieram de outras linguagens e estão retendo um velho hábito de pluralização de nomes. Não use nome do pacote <code>httputils</code>, mas <code>httputil</code>!</p>

<pre><code class="language-go">package httputils  // DON'T DO IT, USE SINGULAR FORM!!
</code></pre>

<h3 id="renomear-deve-seguir-as-mesmas-regras">Renomear deve seguir as mesmas regras</h3>

<p>Se você estiver importando mais de um pacote com o mesmo nome, poderá renomear localmente os nomes dos pacotes. Os renomes devem seguir as mesmas regras mencionadas neste <em>blogpost</em>. Não há nenhuma regra sobre que pacote que você deve renomear. Se você está renomeando a biblioteca de pacotes padrão, é bom adicionar um prefixo Go para fazer o nome de auto documento que é &ldquo;Go biblioteca padrão&rdquo; pacote, por exemplo, <code>gourl</code>, <code>goioutil</code>.</p>

<pre><code class="language-go">import (
	gourl &quot;net/url&quot;

	&quot;myother.com/url&quot;
)
</code></pre>

<h3 id="urls-personalizada-vaidade">URLs personalizada (vaidade)</h3>

<p><code>go get</code> suporta a obtenção de pacotes por uma URL que seja diferente da URL do repositório do pacote. Estas URLs são chamadas de URLs personalizadas e exigem que você sirva uma página com meta tags específicas que as ferramentas Go reconhecem. Você pode servir um pacote com um domínio personalizado e um caminho usando URLs personalizadas.</p>

<p>Por exemplo:</p>

<pre><code class="language-bash">$ go get cloud.google.com/go/datastore
</code></pre>

<p>verifica o código-fonte de <code>https://code.googlesource.com/gocloud</code> bastidores e colocá-lo em seu espaço de trabalho (<strong>GOPATH</strong>) <code>$GOPATH/src/cloud.google.com/go/datastore</code>.</p>

<p>Dado <code>code.googlesource.com/gocloud</code> já está servindo este pacote, seria possível ir buscar o pacote a partir desse URL? A resposta é não, se você impor a URL personalizada.</p>

<p>Para fazer isso, adicione uma instrução import ao pacote. A ferramenta Go rejeitará qualquer importação deste pacote de qualquer outro caminho e exibirá um erro amigável para o usuário. Se você não impor as suas URLs personalizadas, haverá duas cópias do seu pacote que não podem trabalhar em conjunto devido ao <em>namespace</em> diferente.</p>

<pre><code class="language-go">package datastore // import &quot;cloud.google.com/go/datastore&quot;
</code></pre>

<h2 id="documentação-de-pacote">Documentação de pacote</h2>

<p>Documente sempre seu pacote. A documentação do pacote é um comentário de nível superior imediatamente anterior à cláusula <code>package</code>. Para pacotes <em>não-principais</em>, godoc sempre começa com &ldquo;Package {PkgName}&rdquo; e segue com uma descrição. Para pacotes principais, a documentação deve explicar o binário.</p>

<pre><code class="language-go">// Package ioutil implements some I/O utility functions.
package ioutil

// Command gops lists all the processes running on your system.
package main

// Sample helloworld demonstrates how to use x.
package main
</code></pre>

<h3 id="use-doc-go">Use doc.go</h3>

<p>Às vezes, os docs do pacote podem ser longos, especialmente quando fornecem detalhes do uso e das diretrizes. Quando isso acontecer mova o pacote godoc para um arquivo <code>doc.go</code>. (consulte um exemplo de um <a href="https://githubcom/GoogleCloudPlatform/google-cloud-go/blob/master/datastore/doc.go" target="_blank">doc.go</a>.)</p>


	
<p class="article__share">Share this post:
  <a rel="nofollow" href="https://twitter.com/intent/tweet?text=Guia%20de%20estilo%20para%20pacotes%20Go https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f by @avelinorun" target="_blank"><i class="fa fa-twitter-square"></i></a>
  <a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-facebook-square"></i></a>
  <a rel="nofollow" href="https://www.linkedin.com/cws/share?url=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-linkedin-square"></i></a>
  <a rel="nofollow" href="https://plus.google.com/share?url=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-google-plus-square"></i></a>
  <a rel="nofollow" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2favelino.run%2fguia-de-estilo-para-pacotes-go%2f"><i class="fa fa-pinterest-square"></i></a>
</p>



	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "avelino" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </div>
  </div>
</div>




<div class="background">
  <div id="contact" class="container section">
    <div class="row contacts">
      <div class="col-lg-12">
        <div class="footer">

	  
<p class="personal-profile__social">
  <a rel="nofollow" href="https://github.com/avelino" target="_blank"><i class="fa fa-github-square"></i></a>
  <a rel="nofollow" href="https://instagram.com/avelinorun" target="_blank"><i class="fa fa-instagram"></i></a>
  <a rel="nofollow" href="https://twitter.com/avelino" target="_blank"><i class="fa fa-twitter-square"></i></a>
  
  <a rel="nofollow" href="https://linkedin.com/in/avelinorun" target="_blank"><i class="fa fa-linkedin-square"></i></a>
  
</p>



	  
	  <p>written by Avelino</p>
	  
	  <p><a href="https://github.com/avelino/hugo-theme-sarah" target="_blank">Sarah</a> theme for <a href="http://gohugo.io/" target="_blank">Hugo</a>. © <a href="http://avelino.xxx/" target="_blank">Avelino</a> 2018</p>
        </div>
      </div>
    </div>
  </div>
</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js" integrity="sha256-jDnOKIOq2KNsQZTcBTEnsp76FnfMEttF6AV2DF2fFNE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/go.min.js"></script>


<script src="https://avelino.run/js/menu.js?hash=1541291284"></script>
<script src="https://avelino.run/js/progress-list.js?hash=1541291284"></script>
<script src="https://avelino.run/js/section.js?hash=1541291284"></script>
<script src="https://avelino.run/js/mobile-menu.js?hash=1541291284"></script>
<script src="https://avelino.run/js/mbclicker.min.js?hash=1541291284"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-3063031-15', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>

